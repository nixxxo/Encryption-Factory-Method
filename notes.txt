М : Мessage : text string - нaпример "message'
К : crypto-key - random генерирана последователност от поне 16-20 bytes - уникална за връзката с (П)
H : crypto-hash - например SHA1, SHA256
ED : encrypt/decrypt - метод/шифър който се ползва за криптиране/декриптиране, ED е например 'ChaCha20' (или друг) 
S : seed, nonce за crypto-hash

1) в началото сте се уговорили и сте си разменили по сигурен начин - крипто-параметрите на връзката с (П) К, H, ED, S
2) процедура на криптиране - примерен вариант (има и по сложни и по сигурни, но това по натам): 

h = H(M, S)
е = ED( M, K, encrypt )
msg_send = { "hash": h, "emsg: e }
изпращаш до (П) msg_to_send, например прикачен файл на е-майл, msg_send не може да се разбере (понеже криптиран) от друг дори и да прихване е-майл-а някъде по трасето до (П); 

3) декриптиране и проверка (П) приема съобщението - вижда по емайл че от теб и знае че за да го декриптира трябва да ползва K,H,ED,S разменени преди време; 
d = ED( msg_send.emsg, K, decrypt ) - така получава разшифрираното съобщение - иска да провери това ли е оргиналното h1 = H(d, S) сравнява полученият хеш msg_send.h с изчисленият h1 - ако са еднакви, значи е оригиналното съобщение; 

В този примерен смисъл е това, което описах в задачата в началото - разликата е че съобщениеот се записва във файл, и се добавят допълнителен атрибут 'type' - за да се знае кои крипто-параметри (K,H,ED,S) да се използват в последствие за декриптиране; В твоите пример - има ли версия която работ със симетричен шифър - както е пример по нагора - ако това работи - т.е. може да криптираш, записваш до файл и после да го декриптираш - значи е ОК. 

4) Асиметричното криптиране - то всъщност е по сигурно, понеже може и да се подписват цифрово съобщенията, просто ползва набор от public-private keys на двете страни - при което само public keys се споделят; т.е. ако се криптира нещо с твоят public-key, само ти с твоят private key може да го декриптираш. Би ли могло към момента, да си сигурено че симетричната работи ОК, имай в предвид че трябва да ползваш 'stream ciphers' - ако е блоков, този разчита че му подаваш фиксирани блокове с данни за да ги процесс - и ако са с различен размер не работят; Поздрави Илиан 
